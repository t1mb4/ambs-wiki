<?xml version="1.0" encoding="windows-1251"?>
<rss version="2.0">
<channel>
<title>IpstudioWiki - ПримерыРаботыСipStudioAmbs/НетарификацияЗвонка/ПримерРешения</title>
<link>http://78.46.73.113/wiki/wakka.php?wakka=ПримерыРаботыСipStudioAmbs/НетарификацияЗвонка/ПримерРешения</link>
<description>History/revisions of IpstudioWiki/ПримерыРаботыСipStudioAmbs/НетарификацияЗвонка/ПримерРешения</description>
<language>en-us</language>
<item>
<title>2009-11-05 14:01:19</title>
<link>http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija/show&amp;time=2009-11-05+14%3A01%3A19</link>
<description>&lt;div class="pageBefore">&lt;img src="http://78.46.73.113/wiki/images/z.gif" width="1" height="1" border="0" alt="" style="display:block" align="top" />&lt;/div>&lt;div class="page">
&lt;b>Сравнение версий &lt;a name=".primeryrabotysipstudioambs.netarifikacijazvonka.primerreshenija" href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;v=vh7" class="">/Примеры&amp;nbsp;Работы&amp;nbsp;Сip&amp;nbsp;Studio&amp;nbsp;Ambs&amp;nbsp;/&amp;nbsp;Нетарификация&amp;nbsp;Звонка&amp;nbsp;/&amp;nbsp;Пример&amp;nbsp;Решения&lt;/a> за &lt;a href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;time=2009-11-05+14%3A01%3A19">2009-11-05 14:01:19&lt;/a> и &lt;a href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija">2009-11-05 14:01:46&lt;/a>&lt;/b>&lt;br />
&lt;br />
No differences.&lt;/div>
</description>
</item>
<item>
<title>2009-10-30 14:14:49</title>
<link>http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija/show&amp;time=2009-10-30+14%3A14%3A49</link>
<description>&lt;div class="pageBefore">&lt;img src="http://78.46.73.113/wiki/images/z.gif" width="1" height="1" border="0" alt="" style="display:block" align="top" />&lt;/div>&lt;div class="page">
&lt;b>Сравнение версий &lt;a  href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;v=vh7" class="">/Примеры&amp;nbsp;Работы&amp;nbsp;Сip&amp;nbsp;Studio&amp;nbsp;Ambs&amp;nbsp;/&amp;nbsp;Нетарификация&amp;nbsp;Звонка&amp;nbsp;/&amp;nbsp;Пример&amp;nbsp;Решения&lt;/a> за &lt;a href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;time=2009-10-30+14%3A14%3A49">2009-10-30 14:14:49&lt;/a> и &lt;a href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;time=2009-11-05+14%3A01%3A19">2009-11-05 14:01:19&lt;/a>&lt;/b>&lt;br />
&lt;br />
&lt;b>Добавлено:&lt;/b>&lt;br />
&lt;div class="additions">||**Замечание:**| Если в&amp;nbsp;будущем нужно будет изменить или&amp;nbsp;добавить трансляции к&amp;nbsp;шлюзам(клонам), нужно остановить текущий шлюз стоп-датой и&amp;nbsp;добавить новый шлюз(клон) с&amp;nbsp;новыми настройками. Это&amp;nbsp;необходимо чтобы система могла всегда перетарифицировать прошедший ранее трафик. Если изменить рабочий вариант шлюза(клона) на&amp;nbsp;новый, старый прошедший трафик останется без&amp;nbsp;шлюза и&amp;nbsp;будет показан как&amp;nbsp;не&amp;nbsp;калькулированный.||&lt;/div>&lt;/div>
</description>
</item>
<item>
<title>2009-10-30 13:46:11</title>
<link>http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija/show&amp;time=2009-10-30+13%3A46%3A11</link>
<description>&lt;div class="pageBefore">&lt;img src="http://78.46.73.113/wiki/images/z.gif" width="1" height="1" border="0" alt="" style="display:block" align="top" />&lt;/div>&lt;div class="page">
&lt;b>Сравнение версий &lt;a  href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;v=vh7" class="">/Примеры&amp;nbsp;Работы&amp;nbsp;Сip&amp;nbsp;Studio&amp;nbsp;Ambs&amp;nbsp;/&amp;nbsp;Нетарификация&amp;nbsp;Звонка&amp;nbsp;/&amp;nbsp;Пример&amp;nbsp;Решения&lt;/a> за &lt;a href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;time=2009-10-30+13%3A46%3A11">2009-10-30 13:46:11&lt;/a> и &lt;a href="http://78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/NetarifikacijaZvonka/PrimerReshenija&amp;amp;time=2009-10-30+14%3A14%3A49">2009-10-30 14:14:49&lt;/a>&lt;/b>&lt;br />
&lt;br />
&lt;b>Добавлено:&lt;/b>&lt;br />
&lt;div class="additions">&lt;a name="h229-1">&lt;/a>&lt;h2>Пример решения не&amp;nbsp;тарификации звонков&lt;/h2>
Рассмотрим рабочую ситуацию, есть 2 компании использующие один шлюз. Одна компания занимается оригинацией трафика другая терминацией.&lt;br />
Был&amp;nbsp;добавлен один шлюз двум операторам в&amp;nbsp;режиме 3(оригинация и&amp;nbsp;терминация). У&amp;nbsp;одного из&amp;nbsp;операторов была добавлена трансляция. &lt;br />
В&amp;nbsp;результате получаем, что&amp;nbsp;иногда звонки отбиваются на&amp;nbsp;входе и&amp;nbsp;иногда прошедшие звонки не&amp;nbsp;ассоциируются с&amp;nbsp;оператором.&lt;br />
&lt;img src="http://78.46.73.113/wiki/files/uncalc_sample.jpg" alt=" (48&amp;nbsp;Кб)" title=" (48&amp;nbsp;Кб)" width='1090' height='63' />&lt;br />
Проверяем каким операторам принадлежит в&amp;nbsp;системе шлюз &amp;#147;192.168.0.20&amp;#148; с&amp;nbsp;помощью формы &amp;laquo;Отчет по&amp;nbsp;операторам&amp;raquo;.&lt;br />
Из&amp;nbsp;результата видно, что&amp;nbsp;шлюз как&amp;nbsp;и&amp;nbsp;планировалось заведен двум операторам оригинатору и&amp;nbsp;терминатору. &lt;br />
&lt;img src="http://78.46.73.113/wiki/files/uncalc_chk.jpg" alt=" (126&amp;nbsp;Кб)" title=" (126&amp;nbsp;Кб)" width='466' height='347' />&lt;br />
Теперь нужно рассмотреть как&amp;nbsp;эти шлюзы заведены у&amp;nbsp;операторов. &lt;br />
У&amp;nbsp;терминирующего оператора на&amp;nbsp;шлюзе нет&amp;nbsp;трансляций.&lt;br />
&lt;img src="http://78.46.73.113/wiki/files/uncalc_term_info.jpg" alt=" (183&amp;nbsp;Кб)" title=" (183&amp;nbsp;Кб)" width='655' height='424' />&lt;br />
У&amp;nbsp;оригинирующего оператора присутствует пустая трансляция.&lt;br />
&lt;img src="http://78.46.73.113/wiki/files/uncalc_orig_info.jpg" alt=" (184&amp;nbsp;Кб)" title=" (184&amp;nbsp;Кб)" width='653' height='424' />&lt;br />
||**Замечание:**| Нельзя использовать пустые трансляции. При&amp;nbsp;маршрутизации входящего звонка система ищет сайт, где&amp;nbsp;заведен этот шлюз и&amp;nbsp;проверяет трансляции шлюза. Тот&amp;nbsp;сайт, где&amp;nbsp;входящий звонок удовлетворяет правилам трансляции будет выбран как&amp;nbsp;сайт оригинатора. После выбора сайта, на&amp;nbsp;этом сайте ищется тарифный план, по&amp;nbsp;которому будет производиться тарификация звонка. Точно также происходит и&amp;nbsp;с выбором терминирующего оператора.||&lt;br />
В&amp;nbsp;рассматриваемом примере входящий звонок может быть принят и&amp;nbsp;на сайт оригинатора и&amp;nbsp;на сайт терминатора (поскольку по&amp;nbsp;правилам трансляции может пройти на&amp;nbsp;оба сайта), но&amp;nbsp;на сайте терминатора он&amp;nbsp;будет отбит, поскольку нет&amp;nbsp;тарифного плана оригинации. Точно такая же&amp;nbsp;картина происходит и&amp;nbsp;с терминацией, когда звонок отправляется на&amp;nbsp;рассматриваемого терминирующего оператора система может занести его&amp;nbsp;оригинатору и&amp;nbsp;непротарифицировать.&lt;br />
Для&amp;nbsp;того чтобы исправить сложившуюся ситуацию нужно более точно указать правила трансляции. С&amp;nbsp;сайта оригинации нам&amp;nbsp;нужно получать трафик без&amp;nbsp;трансляций, но&amp;nbsp;отправлять трафик с&amp;nbsp;этого сайта не&amp;nbsp;нужно. Исходя из&amp;nbsp;этого условия, мы&amp;nbsp;можем добавить &amp;laquo;вымышленную трансляцию&amp;raquo; на&amp;nbsp;отправку трафика с&amp;nbsp;этого сайта. Трансляцию на&amp;nbsp;прием трафика с&amp;nbsp;этого сайта трогать не&amp;nbsp;будем, трафик идет без&amp;nbsp;трансляций.&lt;br />
&lt;img src="http://78.46.73.113/wiki/files/uncalc_orig_corr.jpg" alt=" (184&amp;nbsp;Кб)" title=" (184&amp;nbsp;Кб)" width='653' height='424' />&lt;br />
На&amp;nbsp;сайте терминирующего оператора работает с&amp;nbsp;точностью до&amp;nbsp;наоборот правило. Принимать трафик не&amp;nbsp;нужно, отправлять трафик без&amp;nbsp;трансляций. Таким образом можно добавить &amp;laquo;вымышленную трансляцию&amp;raquo; на&amp;nbsp;прием трафика и&amp;nbsp;не трогать отправку. &lt;br />
&lt;img src="http://78.46.73.113/wiki/files/uncalc_orig_corr.jpg" alt=" (184&amp;nbsp;Кб)" title=" (184&amp;nbsp;Кб)" width='653' height='424' />&lt;br />
После перетарификации с&amp;nbsp;ретрансляцией номеров уже&amp;nbsp;прошедшего трафика приведенный выше пример будет исправлен, будет точно определен терминирующий оператор, поскольку не&amp;nbsp;будет других вариантов куда отнести звонок. Также прекратятся проблемы с&amp;nbsp;отбоем звонков на&amp;nbsp;входе, поскольку оригинирующей оператор всегда будет определяться точно.&lt;/div>&lt;br />
&lt;b>Удалено:&lt;/b>&lt;br />
&lt;div class="deletions">&lt;a name="h229-1">&lt;/a>&lt;h2>Решение проблем не&amp;nbsp;тарификации звонков&lt;/h2>
В&amp;nbsp;процессе работы с&amp;nbsp;системой могут встречаться такие ситуации, когда рабочие данные меняют задним числом (удаляют шлюз или&amp;nbsp;тарифный код), &lt;br />
в&amp;nbsp;этом случае в&amp;nbsp;конце месяца прошедшие звонки для&amp;nbsp;которых были удалены данные могут показываться как&amp;nbsp;&amp;laquo;не тарифицированные&amp;raquo; звонки.&lt;br />
Есть несколько признака, по&amp;nbsp;которым можно определить, что&amp;nbsp;в&amp;nbsp;системе есть не&amp;nbsp;тарифицированные звонки: &lt;br />
&lt;ol type="1">&lt;li value="1"> При&amp;nbsp;составлении инвойса, в&amp;nbsp;нем присутствуют направления со&amp;nbsp;следующими признаками:
&lt;ul>&lt;li> Направления, у&amp;nbsp;которых перед названием направления стоит символ “_”(подчеркивание) 
&lt;/li>&lt;li> Направления, названия которых состоят только из&amp;nbsp;символа подчеркивания, но&amp;nbsp;по которым прошли минуты.
&lt;/li>&lt;li> Направления, без&amp;nbsp;названия, но&amp;nbsp;по которым прошли минуты.
&lt;/li>&lt;/ul>&lt;/li>&lt;li value="2"> В&amp;nbsp;таблице суммарной статистики в&amp;nbsp;разделе “Call details”, параметры “not calculated minutes (term)” и&amp;nbsp;“not calculated minutes (orig)” имеют значение отличное от&amp;nbsp;нуля. &lt;/li>&lt;/ol>
&lt;img src="http://78.46.73.113/wiki/files/ambs_uncalc_1.gif" alt=" (11&amp;nbsp;Кб)" title=" (11&amp;nbsp;Кб)" width='243' height='183' />&lt;br />
&lt;ol type="1">&lt;li value="3"> В&amp;nbsp;сводной статистике присутствует статистика по&amp;nbsp;оператору &amp;#147;Any&amp;#148; (не определенный).&lt;/li>&lt;/ol>
При&amp;nbsp;детальном (show: details) рассмотрении таких звонков в&amp;nbsp;форме “Call details” нужно выбрать режим &amp;#147;show: uncalculated calls&amp;#148;. &lt;br />
Звонки для&amp;nbsp;которых отсутствует какой-то из&amp;nbsp;ключевых параметров работы  будут иметь цену “-1”, т.е. на&amp;nbsp;данный момент системе не&amp;nbsp;удается &lt;br />
найти шлюз(меру) или&amp;nbsp;цену в&amp;nbsp;тарифе оператора на&amp;nbsp;эти звонки по&amp;nbsp;которой они&amp;nbsp;проходили ранее.&lt;br />
||**Замечание:**| Исключение составляют звонки с&amp;nbsp;нулевой продолжительностью разговора. Звонки с&amp;nbsp;нулевой длительностью не&amp;nbsp;рассматриваются в&amp;nbsp;процессе тарификации.||&lt;br />
Не&amp;nbsp;тарификация звонков может произойти по&amp;nbsp;следующим причинам:&lt;br />
&lt;ol type="2">&lt;li value="1"> Во&amp;nbsp;время прохождения звонков в&amp;nbsp;тарифном плане операторов присутствовала цена на&amp;nbsp;это направление, после этого произошло одно из&amp;nbsp;следующих событий:
&lt;ul>&lt;li> был&amp;nbsp;изменен код&amp;nbsp;направления в&amp;nbsp;тарифном плане оператора и&amp;nbsp;теперь система не&amp;nbsp;может протарифицировать прошедшие звонки;
&lt;/li>&lt;li> изменили даты работы кода направления таким образом, что&amp;nbsp;прошедшие звоноки не&amp;nbsp;попадают в&amp;nbsp;период работы этого нового кода;
&lt;/li>&lt;li> направление полностью удалили из&amp;nbsp;тарифного плана оператора. 
&lt;/li>&lt;/ul>&lt;/li>&lt;li value="2"> Во&amp;nbsp;время прохождения звонков, у&amp;nbsp;оператора был&amp;nbsp;закреплен один тарифный план, в&amp;nbsp;котором присутствовали данные направления. Позже тарифный план оператора заменили на&amp;nbsp;новый, в&amp;nbsp;котором данное направление отсутствует.
&lt;/li>&lt;li value="3"> После прохождения звонков, был&amp;nbsp;изменен ip-адрес шлюза оператора, без&amp;nbsp;сохранения старого адреса в&amp;nbsp;истории работы, что&amp;nbsp;привело к&amp;nbsp;потере связи между звонками и&amp;nbsp;шлюзами оператора.
&lt;/li>&lt;li value="4"> У&amp;nbsp;оператора присутствовало несколько сайтов. Звонки прошли по&amp;nbsp;одному сайту, который в&amp;nbsp;последствии был&amp;nbsp;удален. Также возможна ситуация, когда звонки прошли с&amp;nbsp;одним префиксом, который в&amp;nbsp;последствии был&amp;nbsp;заменен на&amp;nbsp;другой.    
&lt;/li>&lt;li value="5"> Звонки прошли через меру,которую в&amp;nbsp;дальнейшем удалили из&amp;nbsp;системы, что&amp;nbsp;привело к&amp;nbsp;потере связи звонков и&amp;nbsp;шлюзов операторов. &lt;/li>&lt;/ol>
В&amp;nbsp;результате выше описанных причин при&amp;nbsp;очередном пересчете статистики в&amp;nbsp;системе появятся такие &amp;laquo;не тарифицированные&amp;raquo; звонки. &lt;br />
Чтобы разрешить данную проблему, нужно выполнить следующие проверки:&lt;br />
&lt;ul>&lt;li> Детально посмотреть на&amp;nbsp;&amp;laquo;не тарифицированные&amp;raquo; звонки в&amp;nbsp;форме &amp;#147;Call Details&amp;#148;. Выбрать один такой звонок и&amp;nbsp;разобраться в&amp;nbsp;причине не&amp;nbsp;тарификации.
&lt;/li>&lt;li> Проверить тарифный план оператора в&amp;nbsp;разделе &amp;#147;Edit Tariffs&amp;#148;, используя параметр “history”. Убедится, что&amp;nbsp;в&amp;nbsp;момент прохождения звонков у&amp;nbsp;этого оператора в&amp;nbsp;тарифном плане присутствовал тариф на&amp;nbsp;это направление с&amp;nbsp;правильной ценой.
&lt;/li>&lt;li> Проверить адреса шлюзов операторов, по&amp;nbsp;которым прошли звонки. Нужно убедиться, что&amp;nbsp;адреса были активны и&amp;nbsp;назначены правильным операторам в&amp;nbsp;момент прохождения звонка.
&lt;/li>&lt;li> Если система определила адрес шлюза, но&amp;nbsp;название оператора указано как&amp;nbsp;“Any”, значит звонки прошли, но&amp;nbsp;теперь система не&amp;nbsp;может связать адрес с&amp;nbsp;конкретным оператором. В&amp;nbsp;этом случае нужно найти, кому принадлежал этот адрес в&amp;nbsp;период прохождения звонков и&amp;nbsp;убедится что&amp;nbsp;в&amp;nbsp;то время он&amp;nbsp;принадлежал правильному оператору. 
&lt;/li>&lt;/ul>&lt;div class="indent">Для этого можно воспользоваться разделом “Operator reports”. Если позже этот же&amp;nbsp;адрес будет использоваться другим оператором, нужно закрыть адрес у&amp;nbsp;старого оператора &amp;laquo;Стоп датой&amp;raquo; и&amp;nbsp;завести у&amp;nbsp;нового оператора со&amp;nbsp;&amp;laquo;Старт датой&amp;raquo; позже указанной &amp;laquo;Стоп даты&amp;raquo;, чтобы две&amp;nbsp;записи одного шлюза не&amp;nbsp;пересекались.&lt;br />
&lt;/div>&lt;ul>&lt;li> Проверить трансляции номера, с&amp;nbsp;какими он&amp;nbsp;пришел и&amp;nbsp;с каками ушел. Убедится, что&amp;nbsp;трансляции обработаны правильно.&lt;/li>&lt;/ul>
Когда причина не&amp;nbsp;тарифицированных звонков будет найдена и&amp;nbsp;устранена, нужно провести процесс перетарификации звонков за&amp;nbsp;период их&amp;nbsp;прохождения. Для&amp;nbsp;этого в&amp;nbsp;разделе &amp;#147;Recalculation&amp;#148; (Reports &amp;ndash; Recalculation) нужно выбрать оператора, указать период перетарификации и&amp;nbsp;нажать кнопку “Recharge calls” для&amp;nbsp;запуска процесса перетарификации звонков по&amp;nbsp;выбранному оператору. &lt;br />
После запуска процесса, можно просматривать его&amp;nbsp;ход клавишами “Show recharge process” и&amp;nbsp;“Show recalc process” (процесс включает в&amp;nbsp;себя два&amp;nbsp;процесса: перетарификацию и&amp;nbsp;пересчет статистики). &lt;br />
Нужно дождаться завершения обоих процессов (пока не&amp;nbsp;выдаст надпись &amp;ndash; FINISHED) и&amp;nbsp;проверить результат в&amp;nbsp;разделе &amp;#147;Call Details&amp;#148;. Если вы&amp;nbsp;все сделали верно, не&amp;nbsp;тарифицированные  звонки будут пересчитаны и&amp;nbsp;показаны как&amp;nbsp;нормальные. Если не&amp;nbsp;тарифицированные звонки остались, значит одна из&amp;nbsp;причин не&amp;nbsp;тарификации не&amp;nbsp;была устранена.&lt;/div>&lt;/div>
</description>
</item>
</channel>
</rss>
