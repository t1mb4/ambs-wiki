
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from 78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/PodgruzkaCDR&v=kzz by HTTrack Website Copier/3.x [XR&CO'2006], Wed, 25 Jul 2012 16:10:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=windows-1251"><!-- /Added by HTTrack -->
<head>
  <title>
  	IpstudioWiki : Примеры&nbsp;Работы&nbsp;Сip&nbsp;Studio&nbsp;Ambs&nbsp;/&nbsp;Подгрузка&nbsp;CDR  </title>
			  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta http-equiv="content-type" content="text/html; charset=windows-1251" />
  <link rel="stylesheet" type="text/css" href="themes/default/css/wakka.css" />
  <link rel="shortcut icon" href="themes/default/icons/wacko.ico" type="image/x-icon" />
  <link rel="alternate" type="application/rss+xml" title="RecentChanges in RSS" href="xml/recentchanges_ipstudiowiki.xml" />
  <link rel="alternate" type="application/rss+xml" title="History/revisions of ПримерыРаботыСipStudioAmbs/ПодгрузкаCDR in RSS" href="wakka13c1.php?wakka=PrimeryRabotySipStudioAmbs/PodgruzkaCDR/revisions.xml" />

<script language="JavaScript" type="text/javascript" src="js/default.js"></script>
<script language="JavaScript" type="text/javascript" src="js/protoedit.js"></script>
<script language="JavaScript" type="text/javascript" src="js/wikiedit2.js"></script>

</head>

<body onload="all_init();" leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0">

<table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td>

<form action="http://78.46.73.113/wiki/wakka.php?wakka=Login"  method="post" >
<input type="hidden" name="wakka" value="Login" />
<input type="hidden" name="action" value="login" />
<div class="header">
  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
  	<tr>
  		<td align="left" class="logo_header">
  		
  		</td>
  		<td align="right" valign="top" class="logo_header"> 
								<span>
					<a href="wakka6b42.html?wakka=Login">
						<b>Вход</b>
					</a>
				</span>
				<!-- <span class="nobr"><input type="hidden" name="goback" value="PrimeryRabotySipStudioAmbs/PodgruzkaCDR" 
				/><strong>Вход:&nbsp;</strong><input 
				type="text" name="name" size="18" class="login" />&nbsp;Пароль:&nbsp;<input type="password" name="password"  
				class="login" size="8" />&nbsp;<input type="image" 
				src="http://78.46.73.113/wiki/themes/default/icons/login.gif" alt=">>>" align="top" /></span>-->
							</td>
		</tr>
		<tr>
			<td colspan="2" class="bookmarks">
							</td>
		</tr>
		<tr>
			<td colspan="2" class="logo_header">
				<b>
				<!--     <span class="main">IpstudioWiki:</span> -->
				     <span class="main"><a href="wakkad0e2.html?wakka=KnowledgeBase">Knowledge&nbsp;Base</a></span>
								     <span class="main">:: <a  href="wakka2c0b.html?wakka=PrimeryRabotySipStudioAmbs&amp;v=1c1f" class="" title="Примеры&nbsp;Работы&nbsp;Сip&nbsp;Studio&nbsp;Ambs">ПримерыРаботыСipStudioAmbs</a>/ПодгрузкаCDR</span>     
								</b>
				<!--     <span class="main"><a class="Search" title="" 
				     href="http://78.46.73.113/wiki/wakka.php?wakka=TextSearch&amp;phrase=%CF%F0%E8%EC%E5%F0%FB%D0%E0%E1%EE%F2%FB%D1ipStudioAmbs%2F%CF%EE%E4%E3%F0%F3%E7%EA%E0CDR">...</a></span> -->
				</td>
			</tr>
		</table>
</form>

<div class="pageBefore">
	<img src="images/z.gif" width="1" height="1" border="0" alt="" style="display:block" align="top" />
</div><div class="page">
<a name="p52897-1"></a><p class="auto" id="p52897-1"><strong> <a name=".." href="wakka2c0b.html?wakka=PrimeryRabotySipStudioAmbs&amp;v=1c1f" class="" title="ПримерыРаботыСipStudioAmbs/..">В оглавление</a> </strong></p><a name="h100-1"></a><h2>Загрузка CDR-ов в&nbsp;ручном режиме</h2>
<br /><a name="p52897-2"></a><p class="auto" id="p52897-2">
Для&nbsp;того, чтобы подгрузить звонки из&nbsp;CDR-ов Меры, за&nbsp;прошедший период нужно выполнить следующие действия:</p><br /><a name="p52897-3"></a><p class="auto" id="p52897-3">
1. Убедиться, что&nbsp;CDR-ы за&nbsp;требуемый период находятся в&nbsp;папке для&nbsp;CDR-ов.</p><br /><a name="p52897-4"></a><p class="auto" id="p52897-4">
2. Поправить файл с&nbsp;датой последней загрузки CDR-ов в&nbsp;биллинге, на&nbsp;дату с&nbsp;которой нужно подгрузить логи. </p><br /><a name="p52897-5"></a><p class="auto" id="p52897-5">
<em><u>Замечание:</u> Если производится загрузка CDR-ов с&nbsp;удаленной Меры, все&nbsp;действия нужно производить на&nbsp;этой удаленной Мере.</em></p><br /><a name="p52897-6"></a><p class="auto" id="p52897-6">
В&nbsp;консоли сервера нужно выполнить команды:</p><br />
<div class="indent">cd /usr/local/billing<br />
vi&nbsp;lastupdated</div>
<br /><a name="p52897-7"></a><p class="auto" id="p52897-7">
в&nbsp;этом файле &#147;lastupdated&#148; хранится дата последней загрузки CDR-ов в&nbsp;формате: <!--notypo-->&lt;год&gt;&lt;месяц&gt;&lt;день&gt;&lt;час&gt;&lt;минуты&gt;&lt;секунды&gt;<!--/notypo--></p><br />
<div class="indent">Пример: 20070130130000 (<span class="nobr">2007&ndash;01&ndash;30</span> 13:00:00)</div>
<br /><a name="p52897-8"></a><p class="auto" id="p52897-8">
Нужно исправить дату, на&nbsp;дату с&nbsp;которой планируется загрузить CDR-ы, например: 20070102000000 (<span class="nobr">2007&ndash;01&ndash;02</span> 00:00:00)<br />
Сохранить результат и&nbsp;закрыть файл. </p><br /><a name="p52897-9"></a><p class="auto" id="p52897-9">
3. При&nbsp;следующем процессе парсинга, биллинг автоматически начнет загрузку CDR-ов начиная с&nbsp;указанной даты.<br />
Можно запустить процесс парсинга в&nbsp;ручную, выполнив команду:</p><br />
<div class="indent">/usr/local/billing/bin/load_cdr.pl</div>
<br /><a name="p52897-10"></a><p class="auto" id="p52897-10">
<em><u>Примечание:</u> Процесс парсинга довольно длительный, чем&nbsp;больше период загрузки, тем&nbsp;дольше будет проходить процесс. Загрузка данных за&nbsp;пару дней может занимать час&nbsp;и&nbsp;более по&nbsp;времени. Длительность процесса вызвана многочисленными проверками, которые производятся над&nbsp;каждым загружаемым звонком, на&nbsp;его наличие в&nbsp;базе биллинга. Это&nbsp;сделано, чтобы избежать дублирования данных.</em></p><br /><a name="p52897-11"></a><p class="auto" id="p52897-11">
4. Можно проводить мониторинг процесса загрузки CDR-ов следующими командами:</p><br />
<div class="indent">ps ax&nbsp;| grep load_cdr.pl</div>
<br /><a name="p52897-12"></a><p class="auto" id="p52897-12">
Если процесс выполняется, значит загрузка еще&nbsp;идет. Когда процесс прекратит выполняться, значит загрузка данных завершена.</p><br />
<div class="indent">more /usr/local/billing/lastupdated</div>
<br /><a name="p52897-13"></a><p class="auto" id="p52897-13">
Покажет последнюю дату, за&nbsp;которую биллинг уже&nbsp;обработал CDR-ы, по&nbsp;мере подгрузки данных значение даты и&nbsp;времени в&nbsp;этом файле будут меняться.</p><br /><a name="p52897-14"></a><p class="auto" id="p52897-14">
5. По&nbsp;завершению процесса загрузки нужно провести полный пересчет статистики в&nbsp;биллинге (Reports &ndash; Recalculation &ndash; Recalculate calls) за&nbsp;период подгрузки CDR-ов.</p><br /><a name="p52897-15"></a><p class="auto" id="p52897-15">
<strong> <a  href="wakka2c0b.html?wakka=PrimeryRabotySipStudioAmbs&amp;v=1c1f" class="" title="ПримерыРаботыСipStudioAmbs/..">В оглавление</a> </strong></p>   <script language="JavaScript" type="text/javascript">
   var dbclick = "page";
  </script>
 <br style="clear:both" />&nbsp;
</div>

<form action="http://78.46.73.113/wiki/wakka.php?wakka=TextSearch"  method="get" >
<input type="hidden" name="wakka" value="TextSearch" />
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="footer">
	<tr>
		<td>
			 
			
			  <span class="searchbar nobr">Поиск: <input type="text" name="phrase" size="25" style="border: none; border-bottom: 1px solid #CCCCAA; padding: 0px; margin: 0px;" /></span>
		</td>
		<td align="right">
			<a href="wakkaff66.html?wakka=PrimeryRabotySipStudioAmbs/PodgruzkaCDR/print" target="_new"><img src="themes/default/icons/1print.gif" title="Версия для печати" alt="Версия для печати"  align="middle" border="0" /></a>		</td>
	</tr>
</table>

</form>


<table class="copyright" width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td align="left" class="copyright">
			Created by <a target="_blank" class="copyright" href="http://www.ipstudio.net/">IP Studio Inc.</a>© 2007
		</td>
		<td align="right" class="copyright">
			Powered by <a href="http://wackowiki.com/WackoWiki" target="_blank" title="" class="outerlink">WackoWiki R4.2</a>		</td>
	</tr>
</table>

</td>
</tr>
</table>
</body>
<!-- Mirrored from 78.46.73.113/wiki/wakka.php?wakka=PrimeryRabotySipStudioAmbs/PodgruzkaCDR&v=kzz by HTTrack Website Copier/3.x [XR&CO'2006], Wed, 25 Jul 2012 16:10:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=windows-1251"><!-- /Added by HTTrack -->
</html>