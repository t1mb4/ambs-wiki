<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

<!-- Mirrored from 78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/UstanovkaBinarnogoDistributiva/print by HTTrack Website Copier/3.x [XR&CO'2006], Wed, 25 Jul 2012 16:14:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=windows-1251"><!-- /Added by HTTrack -->
<head>
  <title>IpstudioWiki : ДокументацияIPStudioAMBS/УстановкаНастройкаIPStudioAMBS/УстановкаБинарногоДистрибутива</title>
<meta name="robots" content="noindex, nofollow" />
  <meta http-equiv="content-type" content="text/html; charset=windows-1251" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <link rel="stylesheet" type="text/css" href="http://78.46.73.113/wiki/themes/default/css/wakkaprint.css" />
</head>

<body>

<div class="header">
  IpstudioWiki : <a href="http://78.46.73.113/wiki/wakka.php?wakka=TextSearch?phrase=%C4%EE%EA%F3%EC%E5%ED%F2%E0%F6%E8%FFIPStudioAMBS%2F%D3%F1%F2%E0%ED%EE%E2%EA%E0%CD%E0%F1%F2%F0%EE%E9%EA%E0IPStudioAMBS%2F%D3%F1%F2%E0%ED%EE%E2%EA%E0%C1%E8%ED%E0%F0%ED%EE%E3%EE%C4%E8%F1%F2%F0%E8%E1%F3%F2%E8%E2%E0">ДокументацияIPStudioAMBS/УстановкаНастройкаIPStudioAMBS/УстановкаБинарногоДистрибутива</a> 
</div>

<div class="pageBefore"><img src="http://78.46.73.113/wiki/images/z.gif" width="1" height="1" border="0" alt="" style="display:block" align="top" /></div><div class="page">
<!--notypo--><a name="PageTopLink" href="#PageTopLink" title=""></a>
<!--/notypo--><a name="h25-1"></a><h1>Установка и&nbsp;настройка IP&nbsp;Studio AMBS</h1>
<br />
<strong> <a name=".dokumentacijaipstudioambs" href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS&amp;v=oq3" class="" title="Документация&nbsp;IP&nbsp;Studio&nbsp;AMBS">В оглавление</a> </strong><br />
<ul><li> <a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS&amp;v=jxa#Техническиетребования" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/">Технические требования</a>
</li><li> <a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS&amp;v=jxa#УстановкаIPStudioAMBS" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/">Установка IP&nbsp;Studio AMBS</a>
</li><li> <a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS&amp;v=jxa#ЧтонужнодляустановкиIPStudioAMBS" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/">Информация для&nbsp;установки IP&nbsp;Studio AMBS</a>
</li><li> <strong><a href="#УстановкаБинарногоДистрибутива" name="oУстановкаБинарногоДистрибутива">Инструкция по&nbsp;установке системы с&nbsp;использованием бинарного дистрибутива</a></strong>
</li><li> <strong><a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/PodkljuchenieUdalennojjMery&amp;v=n1v" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Подключение&nbsp;Удаленной&nbsp;Меры">Подключение MVTS-сервера</a></strong>
</li><li> <a name="...ustanovkanastrojjkaipstudioambs.rezhimyispol_zovanijaambs" href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/RezhimyIspol'zovanijaAMBS&amp;v=1as5" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Режимы&nbsp;Использования&nbsp;AMBS">Режимы использования IP&nbsp;Studio AMBS</a>
<ul><li> <a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/RezhimyIspol'zovanijaAMBS&amp;v=1as5#РежимПарсинга" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Режимы&nbsp;Использования&nbsp;AMBS&nbsp;/">Режим Парсинга</a>
</li><li> <a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/RezhimyIspol'zovanijaAMBS&amp;v=1as5#РежимАккаунтинга" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Режимы&nbsp;Использования&nbsp;AMBS&nbsp;/">Режим Аккаунтинга</a>
</li><li> <a  href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/RezhimyIspol'zovanijaAMBS&amp;v=1as5#РежимМаршрутизации" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Режимы&nbsp;Использования&nbsp;AMBS&nbsp;/">Режим Маршрутизации</a>
</li></ul></li><li> <a name="...ustanovkanastrojjkaipstudioambs.proverkaprocessovambs" href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/ProverkaProcessovAMBS&amp;v=1asm" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Проверка&nbsp;Процессов&nbsp;AMBS">Проверка работы процессов IP&nbsp;Studio AMBS</a></li></ul>
<!--notypo--><!--/notypo--><br />
<!--notypo--><!--/notypo--><br />
<!--notypo--><a name="УстановкаБинарногоДистрибутива" href="#УстановкаБинарногоДистрибутива" title=""></a>
<!--/notypo--><a name="h25-2"></a><h2>Инструкция по&nbsp;установке системы с&nbsp;использованием бинарного дистрибутива</h2>
<br />
Для&nbsp;установки системы с&nbsp;использованием бинарного дистрибутива, следуйте нижеизложенной инструкции:<br />
<br />
<strong>1.</strong> Зайдите на&nbsp;сервер под&nbsp;“root” пользователем и&nbsp;выполните следующую команду:<br />
<br />
<div class="indent">scp billinst@213.219.246.22:bin-ambs.v4.0.build.2.tar.gz /usr/local/</div>
<br />
В&nbsp;результате, вы&nbsp;скопируете на&nbsp;свой сервер архив дистрибутива системы IP&nbsp;Studio AMBS. На&nbsp;все вопросы отвечайте – “yes”.  Также, пожалуйста, обратите внимание, размер файла  “billing_bin.tgz“ более 100 Мб, этот процесс займет некоторое время (в зависимости от&nbsp;скорости вашего интернет-канала).<br />
<br />
<div class="action"><div class="action-content"><table class="dtable" border="0">
<tr class="userrow"><td class="usercell"><strong>Примечание:</strong></td><td  class="usercell"> Если у&nbsp;вас возникла ошибка с&nbsp;сообщением об&nbsp;изменении ключей сервера при&nbsp;подключении и&nbsp;авторизации на&nbsp;нем, пожалуйста, удалите файл: /root/.ssh/known_hosts  и&nbsp;повторить попытку еще&nbsp;раз.</td></tr>
</table></div></div> <br />
<br />
<strong>2.</strong> После окончания процесса копирования, распакуйте полученный архив:<br />
<br />
<div class="indent">cd /usr/local<br />
tar&nbsp;-kxzf bin-ambs.v4.0.build.2.tar.gz</div>
<br />
<strong>3.</strong> Теперь нужно создать пользователя, который будет отвечать за&nbsp;все файлы системы, это&nbsp;необходимо для&nbsp;корректной работы системы и&nbsp;процессов обновления. Выполните следующие команды:<br />
<br />
<div class="indent">useradd -d /usr/local/billing ipstudio <br />
passwd ipstudio</div>
<br />
В&nbsp;последней команде вы&nbsp;должны будите придумать и&nbsp;указать пароль для&nbsp;пользователя &ndash; ipstudio, под&nbsp;которым будет работать система.<br />
<br />
<strong>4.</strong> Теперь нужно сделать владельцем всех файлов и&nbsp;папок системы IP&nbsp;Studio AMBS этого нового пользователя “ipstudio”, выполнив следующую команду:<br />
<br />
<div class="indent">chown -R ipstudio /usr/local/billing</div>
<br />
Это&nbsp;очень важный шаг, поскольку, не&nbsp;выполнив его, ваша система не&nbsp;сможет вносить изменения в&nbsp;свои рабочие файлы и&nbsp;производить процесс обновления файлов с&nbsp;центрального сервера обновлений. <br />
<br />
<strong>5.</strong> Теперь нужно скопировать все&nbsp;загрузочные скрипты IP&nbsp;Studio AMBS в&nbsp;общую папку скриптов вашего сервера:<br />
<br />
<div class="indent">cp /usr/local/billing/start_scripts/* /etc/init.d/</div>
<br />
<strong>6.</strong> Отредактируйте файл “ld.so.conf” : <br />
<br />
<div class="indent">vi /etc/ld.so.conf</div>
<br />
Добавьте следующие строки:<br />
<br />
<div class="indent">/usr/local/billing/lib/5.8.0<br />
/usr/local/billing/mysql/lib/mysql</div>
<br />
<strong>7.</strong> После этого выполните команду:<br />
<br />
<div class="indent">ldconfig</div>
<br />
<div class="indent"><em><u>Примечание</u>: При&nbsp;выполнении этой команды сообщения типа: &laquo;ldconfig: /usr/local/billing/lib/5.8.0/libpng12.so.0 is&nbsp;not a&nbsp;symbolic link&raquo; &ndash; это&nbsp;не&nbsp;ошибка.</em><br />
<em>Система сообщает что&nbsp;прописаны реальные пути.</em></div>
<br />
<strong>8.</strong> Отредактируйте файл “/etc/sysconfig/i18n”.<br />
<br />
<div class="indent">vi /etc/sysconfig/i18n</div>
<br />
Вам&nbsp;нужно закомментировать все&nbsp;строки (поставьте в&nbsp;начале строки символ &ndash; #).<br />
<br />
<strong>9.</strong> После этого выполните команды:<br />
<br />
<div class="indent">/etc/init.d/keytable restart </div>
<br />
keytable – может отсутствовать в&nbsp;некоторых версия ОС, это&nbsp;некритично.<br />
<br />
<div class="indent">export LC_ALL=C</div>
<br />
<strong>10.</strong> Отредактируйте файл “bill_util.cfg”. Пример:<br />
<br />
<div class="indent">vi /usr/local/billing/etc/bill_util.cfg</div>
<br />
Проверьте и&nbsp;поправьте данные в&nbsp;следующих строках на&nbsp;ваши реальные данные: <br />
<br />
<div class="indent">HOST=your_ip<br />
MY_IP= your_ip</div>
<br />
<em><u>Примечание:</u> в&nbsp;поле HOST обязательно вписать ip-адрес вашего сервера. Запись типа &ndash; localhost &ndash; будет работать неправильно.</em><br />
<br />
<strong>11.</strong> Добавьте пару строк в&nbsp;планировщик сервера (обычно это&nbsp;“/etc/crontab”), чтобы система регулярно делала резервные копии старых логов и&nbsp;подгружала новые логи MVTS-сервера. Откройте планиковщик командой:<br />
<br />
<div class="indent">vi /etc/crontab</div>
<br />
если вы&nbsp;планируете использовать систему с&nbsp;локальным MVTS, тогда вам&nbsp;нужно добавить следующие строки:<br />
<div class="indent"><br />
<!--notypo-->#IPStudio AMBS backup and cdr parsing scripts<!--/notypo--><br />
<!--notypo-->25 0 * * * root /usr/local/billing/bin/back.sh &gt;&gt; /usr/local/billing/logs/backup.err 2&gt;&amp;1<!--/notypo--><br />
<!--notypo-->10 * * * * root /usr/local/billing/bin/load_cdr.pl &gt;&gt; /usr/local/billing/logs/loader.err 2&gt;&amp;1<!--/notypo--></div>
<br />
если вы&nbsp;планируете использовать систему только с&nbsp;удаленными MVTS-серверами, тогда вам&nbsp;нужно добавить только одну строку:<br />
<br />
<div class="indent"><!--notypo-->25 0 * * * root /usr/local/billing/bin/back.sh &gt;&gt; /usr/local/billing/logs/backup.err 2&gt;&amp;1<!--/notypo--></div>
<!--notypo--><!--/notypo--><br />
Сохраните результат, выйдите из&nbsp;файла и&nbsp;перезапустите планировщик заданий:<br />
<br />
<div class="indent">/etc/init.d/crond restart</div>
<br />
<strong>12.</strong> Проверьте наличие команды на&nbsp;автозапуск IP&nbsp;Studio AMBS при&nbsp;запуске сервера. Для&nbsp;этого откройте папку &#147;rc3.d&#148; и&nbsp;проверьте наличие ссылки "@S98billing.sh&#148;:<br />
<br />
<div class="indent">cd /etc/rc3.d<br />
ls&nbsp;-la</div>
<br />
если такой ссылки нет, ее&nbsp;нужно создать, выполнив следующую команду:<br />
<br />
<div class="indent">ln -s /etc/init.d/billing.sh /etc/rc3.d/S98billing.sh<br />
ln&nbsp;-s /etc/init.d/billing.sh /etc/rc3.d/K98billing.sh</div>
<!--notypo--><!--/notypo--><br />
<strong>13.</strong> Устанавливаем &#147;memcache&#148;, заходим:<br />
<br />
<div class="indent">cd /usr/local/billing/garbage</div>
<br />
<strong>14.</strong> Распаковываем дистрибутивы:<br />
<br />
<div class="indent">tar -zxf libevent-1.3b.tar.gz<br />
tar&nbsp;-zxf memcached-1.2.1.tar.gz</div>
<br />
<strong>15.</strong>  В&nbsp;конфигурационный файл добавляем путь:<br />
<br />
<div class="indent">vi /etc/ld.so.conf</div>
<br />
добавляем строку:<br />
<br />
<div class="indent">/usr/local/lib</div>
<br />
перезапускаем:<br />
<br />
<div class="indent">ldconfig</div>
<br />
<strong>16.</strong> Запускаем процесс установки, последовательно выполняем:<br />
<br />
<div class="indent">cd /usr/local/billing/garbage/libevent-1.3b<br />
<!--notypo-->./configure &amp;&amp; make &amp;&amp; make install<!--/notypo--><br />
<!--notypo--><!--/notypo--><br />
cd&nbsp;/usr/local/billing/garbage/memcached-1.2.1<br />
<!--notypo-->./configure &amp;&amp; make &amp;&amp; make install<!--/notypo--></div>
<br />
перезапускаем:<br />
<br />
<div class="indent">ldconfig</div>
<br />
<strong>17.</strong> Скопируйте полученные письмом файлы лицензии (&lt;license&gt;.lic и&nbsp;./&lt;license&gt;.private)  в&nbsp;папку:<br />
<br />
<div class="indent">cd /usr/local/billing/var/ </div>
<br />
<div class="action"><div class="action-content"><table class="dtable" border="0">
<tr class="userrow"><td class="usercell"><strong>Примечание:</strong></td><td  class="usercell"> Для&nbsp;копирования файлов лицензии на&nbsp;сервер вам&nbsp;нужно использовать бинарный тип&nbsp;копирования, ASCII тип&nbsp;не&nbsp;подходит, пожалуйста будьте внимательны. Если после обновления лицензии, после перезапуска радиуса вы&nbsp;получите ошибку типа:      <br />
<br />
<!--notypo-->Can't use an undefined value as a HASH reference at PERL2EXE_STORAGE/Crypt/RSA/Key/Private.pm line 220.<!--/notypo--><br />
<br />
Значит, вы&nbsp;скопировали файлы лицензии в&nbsp;неправильном формате и&nbsp;вам нужно их&nbsp;переписать повторно, используя правильный тип&nbsp;копирования &ndash; binary.<br />
</td></tr>
</table></div></div> <br />
<br />
<strong>18.</strong> Теперь нужно запустить систему. Выполните следующую команду:<br />
<br />
<div class="indent">/etc/init.d/billing.sh start</div>
<br />
<strong>19.</strong> После того, как&nbsp;система полностью загрузится, нужно обновить ее&nbsp;с центрального сервера до&nbsp;последней доступной версии выполнив команды:<br />
<br />
<div class="indent">cd /usr/local/billing	<br />
scp&nbsp;billinst@213.219.246.22:update.pl ./</div>
<br />
Проверьте файл “bill_util.cfg”. Пример:<br />
<br />
<div class="indent">vi /usr/local/billing/etc/bill_util.cfg</div>
<br />
Проверьте, если отсутствуют следующие строки их&nbsp;нужно добавить: <br />
<br />
<div class="indent">MYSQL=/usr/local/billing/mysql/bin/mysql<br />
OWNER= ipstudio<br />
CONN_STR=billinst@213.219.246.22</div>
<br />
<strong>20.</strong> Провести процесс обновления, выполнив из&nbsp;консоли команды:<br />
<div class="indent">cd /usr/local/billing/<br />
./update.pl</div>
<br />
Дождаться завершения обновления (в процессе нужно будет подтвердить обновление файлов).<br />
<br />
На&nbsp;этом процесс установки можно считать завершенным. <br />
<br />
<div class="action"><div class="action-content"><table class="dtable" border="0">
<tr class="userrow"><td class="usercell"><strong>Примечание:</strong></td><td  class="usercell"> После окончания процесса установки, доступ в&nbsp;систему IP&nbsp;Studio AMBS из&nbsp;браузера будет следующий:</td></tr> 
<tr class="userrow"><td class="usercell"> </td><td  class="usercell"><u>Адрес</u>: <strong> <!--notypo-->http://&lt;адрес_вашего_сервера&gt;/bill/<!--/notypo--> </strong><br />
<u>Пользователь</u>: <strong>admin</strong><br />
<u>Пароль</u>:  <strong>master</strong><br />
<br />
 <span class="cite">После проверки работоспособности системы рекомендуется <u>обязательно</u> сменить пароль для&nbsp;этого пользователя.</span></td></tr>
</table></div></div> <br />
<br />
<strong>По завершению процессы установки рекомендуем в&nbsp;обязательном порядке выполнить <u><a name=".rekomendaciipobezopastnostiserverovambs" href="http://78.46.73.113/wiki/wakka.php?wakka=RekomendaciiPoBezopastnostiServerovAMBS&amp;v=9fl" class="" title="Рекомендации&nbsp;По&nbsp;Безопастности&nbsp;Серверов&nbsp;AMBS">меры по&nbsp;безопасности сервера AMBS</a></u>.</strong><br />
<br />
<!--notypo--><!--/notypo--><br />
<!--notypo--><!--/notypo--><br />
<div class="action"><div class="action-content"><table class="dtable" border="0">
<tr class="userrow"><td class="usercell"><strong><a name="...ustanovkanastrojjkaipstudioambs" href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS&amp;v=jxa#Техническиетребования" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/">&lt;&lt; Назад</a></strong></td><td class="usercell"> <strong><a href="#PageTopLink" name="oPageTopLink">< Наверх ></a></strong></td><td  class="usercell"><strong><a name="...ustanovkanastrojjkaipstudioambs.podkljuchenieudalennojjmery" href="http://78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/PodkljuchenieUdalennojjMery&amp;v=n1v" class="" title="ДокументацияIPStudioAMBS/Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Подключение&nbsp;Удаленной&nbsp;Меры">Вперед &gt;&gt;</a></strong></td></tr>
</table></div></div> <br /></div>
</body>
<!-- Mirrored from 78.46.73.113/wiki/wakka.php?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/UstanovkaBinarnogoDistributiva/print by HTTrack Website Copier/3.x [XR&CO'2006], Wed, 25 Jul 2012 16:14:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=windows-1251"><!-- /Added by HTTrack -->
</html>