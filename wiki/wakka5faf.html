
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from 78.46.73.113/wiki/wakka.php?wakka=ChastyeVoprosyIotvetyPoAMBS/VoprosyPoustanovkeAMBS&v=osy by HTTrack Website Copier/3.x [XR&CO'2006], Wed, 25 Jul 2012 16:06:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=windows-1251"><!-- /Added by HTTrack -->
<head>
  <title>
  	IpstudioWiki : Частые&nbsp;Вопросы&nbsp;Иответы&nbsp;По&nbsp;АМБС&nbsp;/&nbsp;Вопросы&nbsp;Поустановке&nbsp;AMBS  </title>
			  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta http-equiv="content-type" content="text/html; charset=windows-1251" />
  <link rel="stylesheet" type="text/css" href="themes/default/css/wakka.css" />
  <link rel="shortcut icon" href="themes/default/icons/wacko.ico" type="image/x-icon" />
  <link rel="alternate" type="application/rss+xml" title="RecentChanges in RSS" href="xml/recentchanges_ipstudiowiki.xml" />
  <link rel="alternate" type="application/rss+xml" title="History/revisions of ЧастыеВопросыИответыПоАМБС/ВопросыПоустановкеAMBS in RSS" href="wakka462a.php?wakka=ChastyeVoprosyIotvetyPoAMBS/VoprosyPoustanovkeAMBS/revisions.xml" />

<script language="JavaScript" type="text/javascript" src="js/default.js"></script>
<script language="JavaScript" type="text/javascript" src="js/protoedit.js"></script>
<script language="JavaScript" type="text/javascript" src="js/wikiedit2.js"></script>

</head>

<body onload="all_init();" leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0">

<table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td>

<form action="http://78.46.73.113/wiki/wakka.php?wakka=Login"  method="post" >
<input type="hidden" name="wakka" value="Login" />
<input type="hidden" name="action" value="login" />
<div class="header">
  <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
  	<tr>
  		<td align="left" class="logo_header">
  		
  		</td>
  		<td align="right" valign="top" class="logo_header"> 
								<span>
					<a href="wakka6b42.html?wakka=Login">
						<b>Вход</b>
					</a>
				</span>
				<!-- <span class="nobr"><input type="hidden" name="goback" value="ChastyeVoprosyIotvetyPoAMBS/VoprosyPoustanovkeAMBS" 
				/><strong>Вход:&nbsp;</strong><input 
				type="text" name="name" size="18" class="login" />&nbsp;Пароль:&nbsp;<input type="password" name="password"  
				class="login" size="8" />&nbsp;<input type="image" 
				src="http://78.46.73.113/wiki/themes/default/icons/login.gif" alt=">>>" align="top" /></span>-->
							</td>
		</tr>
		<tr>
			<td colspan="2" class="bookmarks">
							</td>
		</tr>
		<tr>
			<td colspan="2" class="logo_header">
				<b>
				<!--     <span class="main">IpstudioWiki:</span> -->
				     <span class="main"><a href="wakkad0e2.html?wakka=KnowledgeBase">Knowledge&nbsp;Base</a></span>
								     <span class="main">:: <a  href="wakkad52c.html?wakka=ChastyeVoprosyIotvetyPoAMBS&amp;v=17ko" class="" title="Частые&nbsp;Вопросы&nbsp;Иответы&nbsp;По&nbsp;АМБС">ЧастыеВопросыИответыПоАМБС</a>/ВопросыПоустановкеAMBS</span>     
								</b>
				<!--     <span class="main"><a class="Search" title="" 
				     href="http://78.46.73.113/wiki/wakka.php?wakka=TextSearch&amp;phrase=%D7%E0%F1%F2%FB%E5%C2%EE%EF%F0%EE%F1%FB%C8%EE%F2%E2%E5%F2%FB%CF%EE%C0%CC%C1%D1%2F%C2%EE%EF%F0%EE%F1%FB%CF%EE%F3%F1%F2%E0%ED%EE%E2%EA%E5AMBS">...</a></span> -->
				</td>
			</tr>
		</table>
</form>

<div class="pageBefore">
	<img src="images/z.gif" width="1" height="1" border="0" alt="" style="display:block" align="top" />
</div><div class="page">
<a name="h108-1"></a><h1><!--notypo-->ЧаВО<!--/notypo--> по&nbsp;IP Studio AMBS</h1>
<br /><a name="p-1360-1"></a><p class="auto" id="p-1360-1">
<strong> <a name=".." href="wakkad52c.html?wakka=ChastyeVoprosyIotvetyPoAMBS&amp;v=17ko" class="" title="ЧастыеВопросыИответыПоАМБС/..">В оглавление</a> </strong></p><ul><li> <a name="obshhajainformacijapoambs" href="wakka5573.html?wakka=ChastyeVoprosyIotvetyPoAMBS/ObshhajaInformacijaPoAMBS&amp;v=p20" class="" title="ЧастыеВопросыИответыПоАМБС/Общая&nbsp;Информация&nbsp;По&nbsp;AMBS">Общая информация по&nbsp;IP Studio AMBS</a>
</li><li> <a name="voprosypoustanovkeambs" href="wakka5faf.html?wakka=ChastyeVoprosyIotvetyPoAMBS/VoprosyPoustanovkeAMBS&amp;v=osy" class="" title="ЧастыеВопросыИответыПоАМБС/Вопросы&nbsp;Поустановке&nbsp;AMBS">Технические вопросы по&nbsp;системе</a>
</li><li> <a name="rabotacoperatorami" href="wakkafd7c.html?wakka=ChastyeVoprosyIotvetyPoAMBS/RabotaCoperatorami&amp;v=16or" class="" title="ЧастыеВопросыИответыПоАМБС/Работа&nbsp;Cоператорами">Операторы и&nbsp;их параметры</a>
</li><li> <a name="rabotastarifami" href="wakka6c9b.html?wakka=ChastyeVoprosyIotvetyPoAMBS/RabotaStarifami&amp;v=5yh" class="" title="ЧастыеВопросыИответыПоАМБС/Работа&nbsp;Старифами">Тарифные планы, валюты, цены и&nbsp;направления</a>
</li><li> <a name="rabotasshljuzami" href="wakka217b.html?wakka=ChastyeVoprosyIotvetyPoAMBS/RabotaSshljuzami&amp;v=xe5" class="" title="ЧастыеВопросыИответыПоАМБС/Работа&nbsp;Сшлюзами">Радиус: шлюзы, маршрутизация, трансляция</a> 
</li><li> <a name="mvtsvoprosy" href="wakka7792.html?wakka=ChastyeVoprosyIotvetyPoAMBS/MvtsVoprosy&amp;v=61q" class="" title="ЧастыеВопросыИответыПоАМБС/Mvts&nbsp;Вопросы">MVTS: конфиги, обновление, статистика, sip-hit</a></li></ul>
<a name="h108-2"></a><h2>Технические вопросы по&nbsp;системе</h2>
<br />
<ul><li> <u><a href="#TECHTT1" name="oTECHTT1">Какой нужен сервер для&nbsp;установки системы IP&nbsp;Studio AMBS?</a></u>
</li><li> <u><a href="#TECHTT2" name="oTECHTT2">Как проверить правильно ли&nbsp;работает система?</a></u>
</li><li> <u><a href="#TECHTT3" name="oTECHTT3">Как перезапустить IP&nbsp;Studio AMBS?</a></u>
</li><li> <u><a href="#TECHTT3a" name="oTECHTT3a">Как добавить Меру и&nbsp;проверить правильно ли&nbsp;добавил?</a></u>
</li><li> <u><a href="#TECHTT4" name="oTECHTT4">Мы завели новую Меру, как&nbsp;можно скопировать на&nbsp;нее шлюзы всех операторов, которые уже&nbsp;есть в&nbsp;системе для&nbsp;другой Меры?</a></u>
</li><li> <u><a href="#TECHTT5" name="oTECHTT5">Где можно посмотреть логи работы AMBS?</a></u>
</li><li> <u><a href="#TECHTT6" name="oTECHTT6">Хотим сменить ip-адрес АМБС-сервера, сам&nbsp;сервер остается прежний. Какие шаги нужно предпринять?</a></u>
</li><li> <u><a href="#TECHTT7" name="oTECHTT7">Можно ли&nbsp;называть шлюзы, роуты операторов на&nbsp;русском языке, система поддерживает кирилицу?</a></u>
</li><li> <u><a href="#TECHTT8" name="oTECHTT8">Как проверить состояние буфера загрузки новых звонков в&nbsp;базу АМБС?</a></u></li></ul>
<br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-2"></a><p class="auto" id="p-1360-2">
<!--notypo--><a name="TECHTT1" href="#TECHTT1" title=""></a>
<!--/notypo--><strong>Вопрос: Какой нужен сервер для&nbsp;установки системы IP&nbsp;Studio AMBS?</strong></p><br /><a name="p-1360-3"></a><p class="auto" id="p-1360-3">
<strong>Ответ:</strong> Для&nbsp;установки системы IP&nbsp;Studio AMBS ваш&nbsp;веб-сервер должен удовлетворять следующим требованиям: <strong><u><a name=".dokumentacijaipstudioambs.ustanovkanastrojjkaipstudioambs" href="wakka0fb3.html?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS&amp;v=jxa#Техническиетребования" class="" title="Документация&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/">Читаем</a></u></strong></p><br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-4"></a><p class="auto" id="p-1360-4">
<!--notypo--><a name="TECHTT2" href="#TECHTT2" title=""></a>
<!--/notypo--><strong>Вопрос: Как&nbsp;проверить правильно ли&nbsp;работает система?</strong></p><br /><a name="p-1360-5"></a><p class="auto" id="p-1360-5">
<strong>Ответ:</strong> На&nbsp;сервере c&nbsp;&#147;IP Studio AMBS&#148; должны выполняются следующие процессы: <strong><u><a name=".dokumentacijaipstudioambs.ustanovkanastrojjkaipstudioambs.proverkaprocessovambs" href="wakkaf2f1.html?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/ProverkaProcessovAMBS&amp;v=1asm" class="" title="Документация&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Проверка&nbsp;Процессов&nbsp;AMBS">Читаем</a></u></strong></p><br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-6"></a><p class="auto" id="p-1360-6">
<!--notypo--><a name="TECHTT3" href="#TECHTT3" title=""></a>
<!--/notypo--><strong>Вопрос: Как&nbsp;перезапустить IP&nbsp;Studio AMBS?</strong></p><br /><a name="p-1360-7"></a><p class="auto" id="p-1360-7">
<strong>Ответ:</strong></p><br /><a name="p-1360-8"></a><p class="auto" id="p-1360-8">
В&nbsp;консоли сервера выполняете следующие команды:</p><br /><a name="p-1360-9"></a><p class="auto" id="p-1360-9">
1. Остановить биллинг и&nbsp;все его&nbsp;процессы:</p><div class="indent"><!--notypo-->/etc/init.d/billing.sh stop<!--/notypo--></div>
<br /><a name="p-1360-10"></a><p class="auto" id="p-1360-10">
2. Проверяете, что&nbsp;все процессы остановилось:</p><div class="indent"><!--notypo-->ps ax | grep pl<!--/notypo--><br />
<!--notypo-->ps ax | grep rad<!--/notypo--><br />
<!--notypo-->ps ax | grep mysql<!--/notypo--></div>
<br /><a name="p-1360-11"></a><p class="auto" id="p-1360-11">
Если какой то&nbsp;из процессов продолжает работать, его&nbsp;нужно сбросить через команду &ndash; &#147;kill -9 PID&#148;.</p><br /><a name="p-1360-12"></a><p class="auto" id="p-1360-12">
3. Запустить АМБС:</p><div class="indent"><!--notypo-->/etc/init.d/billing.sh start<!--/notypo--></div>
<br /><a name="p-1360-13"></a><p class="auto" id="p-1360-13">
4. Проверяете, что&nbsp;все процессы запустились:</p><div class="indent"><!--notypo-->ps ax | grep pl<!--/notypo--> <br />
<!--notypo-->ps ax | grep rad<!--/notypo--><br />
<!--notypo-->ps ax | grep mysql<!--/notypo--></div>
<br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-14"></a><p class="auto" id="p-1360-14">
<!--notypo--><a name="TECHTT3a" href="#TECHTT3a" title=""></a>
<!--/notypo--><strong>Вопрос: Как&nbsp;добавить Меру и&nbsp;проверить правильно ли&nbsp;добавил?</strong></p><br /><a name="p-1360-15"></a><p class="auto" id="p-1360-15">
<strong>Ответ:</strong> </p><br /><a name="p-1360-16"></a><p class="auto" id="p-1360-16">
Прежде всего нужно <strong><u><a name=".dokumentacijaipstudioambs.ustanovkanastrojjkaipstudioambs.podkljuchenieudalennojjmery" href="wakka9162.html?wakka=DokumentacijaIPStudioAMBS/UstanovkaNastrojjkaIPStudioAMBS/PodkljuchenieUdalennojjMery&amp;v=n1v" class="" title="Документация&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Установка&nbsp;Настройка&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Подключение&nbsp;Удаленной&nbsp;Меры">загрузить скрипты АМБС на&nbsp;сервер Меры</a></u></strong> (если Мера удаленная) и&nbsp;<strong><u><a name=".dokumentacijaipstudioambs.razdelequipments.formamvtsservers" href="wakkaaba3.html?wakka=DokumentacijaIPStudioAMBS/RazdelEquipments/FormaMvtsServers&amp;v=219" class="" title="Документация&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Раздел&nbsp;Equipments&nbsp;/&nbsp;Форма&nbsp;Mvts&nbsp;Servers">завести Меру в&nbsp;форме АМБС</a></u></strong>.<br />
На&nbsp;втором рисунке показан рабочий пример, можно заполнить форму по&nbsp;аналогии изменив адреса на&nbsp;реальные.</p><br /><a name="p-1360-17"></a><p class="auto" id="p-1360-17">
Подключение к&nbsp;удаленной Мере рекомендуем организовывать по&nbsp;протоколу sftp, это&nbsp;гарантирует стабильность и&nbsp;безопасность.<br />
Инструкцию, как&nbsp;организовать подключение можете найти на&nbsp;следующей странице: <strong><u><a name=".dokumentacijaipstudioambs.razdelequipments.formamvtsservers.instrukcijasftp" href="wakkacd5b.html?wakka=DokumentacijaIPStudioAMBS/RazdelEquipments/FormaMvtsServers/InstrukcijaSftp&amp;v=lyc" class="" title="Документация&nbsp;IP&nbsp;Studio&nbsp;AMBS&nbsp;/&nbsp;Раздел&nbsp;Equipments&nbsp;/&nbsp;Форма&nbsp;Mvts&nbsp;Servers&nbsp;/&nbsp;Инструкция&nbsp;Sftp">Читаем</a></u></strong></p><br /><a name="p-1360-18"></a><p class="auto" id="p-1360-18">
Как&nbsp;проверить конфигурационные файлы Меры, читаем: <strong><u><a  href="wakka7792.html?wakka=ChastyeVoprosyIotvetyPoAMBS/MvtsVoprosy&amp;v=61q#MVTSTT1" class="" title="ЧастыеВопросыИответыПоАМБС/Mvts&nbsp;Вопросы&nbsp;/">Здесь</a></u></strong><br />
<!--notypo--><!--/notypo--></p><hr noshade="noshade" size="1" />
<br /><a name="p-1360-19"></a><p class="auto" id="p-1360-19">
<!--notypo--><a name="TECHTT4" href="#TECHTT4" title=""></a>
<!--/notypo--><strong>Вопрос: Мы&nbsp;завели новую Меру, как&nbsp;можно скопировать на&nbsp;нее шлюзы всех операторов, которые уже&nbsp;есть в&nbsp;системе для&nbsp;другой Меры?</strong></p><br /><a name="p-1360-20"></a><p class="auto" id="p-1360-20">
<strong>Ответ:</strong></p><br /><a name="p-1360-21"></a><p class="auto" id="p-1360-21">
1. В&nbsp;форме &#147;MVTS Servers&#148; (Equipments &ndash; MVTS Servers) нужно выбрать из&nbsp;списка подключенных Мер&nbsp;уже работающую.</p><br /><a name="p-1360-22"></a><p class="auto" id="p-1360-22">
2. Далее, в&nbsp;выпадающем списке &#147;Copy all&nbsp;gates to:" выбрать <u>новую Меру</u>.</p><br /><a name="p-1360-23"></a><p class="auto" id="p-1360-23">
3.  Нажать &#147;Copy gates&#148;.</p><br /><a name="p-1360-24"></a><p class="auto" id="p-1360-24">
Все&nbsp;шлюза операторов будут скопированы со&nbsp;старой Меры на&nbsp;новую.</p><br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-25"></a><p class="auto" id="p-1360-25">
<!--notypo--><a name="TECHTT5" href="#TECHTT5" title=""></a>
<!--/notypo--><strong>Вопрос: Где&nbsp;можно посмотреть логи работы AMBS?</strong></p><br /><a name="p-1360-26"></a><p class="auto" id="p-1360-26">
<strong>Ответ:</strong> <u><a name=".primeryrabotysipstudioambs.logiambs" href="wakka65c7.html?wakka=PrimeryRabotySipStudioAmbs/LogiAMBS&amp;v=hn6" class="" title="Примеры&nbsp;Работы&nbsp;Сip&nbsp;Studio&nbsp;Ambs&nbsp;/&nbsp;Логи&nbsp;AMBS">&gt; Читаем &lt;</a></u></p><br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-27"></a><p class="auto" id="p-1360-27">
<!--notypo--><a name="TECHTT6" href="#TECHTT6" title=""></a>
<!--/notypo--><strong>Вопрос: Хотим сменить ip-адрес АМБС-сервера, сам&nbsp;сервер остается прежний. Какие шаги нужно предпринять?</strong></p><br /><a name="p-1360-28"></a><p class="auto" id="p-1360-28">
<strong>Ответ:</strong></p><br /><a name="p-1360-29"></a><p class="auto" id="p-1360-29">
Если вы&nbsp;хотите сменить только ip-адрес амбс-сервера (сам сервер остается прежний), необходимо сделать следующие шаги:</p><br /><a name="p-1360-30"></a><p class="auto" id="p-1360-30">
1. На&nbsp;адрес тех.поддержки отправить письмо с&nbsp;заявкой и&nbsp;указанием старого и&nbsp;нового адресов АМБС.</p><br /><a name="p-1360-31"></a><p class="auto" id="p-1360-31">
2. После получения ключей на&nbsp;новый адрес, можно переходить к&nbsp;техническим работам.</p><br /><a name="p-1360-32"></a><p class="auto" id="p-1360-32">
3. Сменить адрес в&nbsp;конфигурации ОС&nbsp;и запустить сервер на&nbsp;новом адресе.</p><br /><a name="p-1360-33"></a><p class="auto" id="p-1360-33">
4. После смены адреса положить файлы нового ключа в&nbsp;папку &laquo;/usr/local/billing/var/&raquo;.</p><br /><a name="p-1360-34"></a><p class="auto" id="p-1360-34">
5. Отредактировать файл &laquo;/usr/local/billing/etc/bill_util.cfg&raquo;,  в&nbsp;параметрах &ndash; &#147;HOST&#148; и&nbsp;&#147;MY_IP&#148; указать новый ip-адрес сервера (именно ip-адрес).</p><br /><a name="p-1360-35"></a><p class="auto" id="p-1360-35">
6. Если используется локальный MVTS под&nbsp;управлением АМБС, проверить &#147;meraproxy.cfg&#148; убедиться, что&nbsp;адрес MVTS изменен на&nbsp;новый ip-адрес. </p><br /><a name="p-1360-36"></a><p class="auto" id="p-1360-36">
7. Для&nbsp;<u>локального MVTS</u>. Зайти в&nbsp;АМБС &#147;Equipments &ndash; Servers&#148;. <br />
По&nbsp;аналогии с&nbsp;MVTS на&nbsp;старом адресе, добавить еще&nbsp;один новый MVTS с&nbsp;аналогичными параметрами, но&nbsp;с новым адресом. </p><br /><a name="p-1360-37"></a><p class="auto" id="p-1360-37">
8. В&nbsp;той же&nbsp;форме, выбрать (точкой) MVTS со&nbsp;старым адресом, далее в&nbsp;выпадающем списке &#147;copy all&nbsp;gates to:&raquo; выбрать MVTS с&nbsp;новым адресом <br />
и&nbsp;скопировать на&nbsp;нее все&nbsp;заведенные в&nbsp;системе шлюзы операторов, чтобы не&nbsp;добавлять их&nbsp;в ручную для&nbsp;новой MVTS. </p><br /><a name="p-1360-38"></a><p class="auto" id="p-1360-38">
9. Здесь же, поскольку MVTS со&nbsp;старым адресом больше нет&nbsp;его можно закрыть, изменив статус на&nbsp;&#147;Closed&#148;.</p><br /><a name="p-1360-39"></a><p class="auto" id="p-1360-39">
<strong>Важно</strong>:  Не&nbsp;нужно удалять MVTS со&nbsp;старым адресом, через него проходил трафик, удаление окажет прямое влияние на&nbsp;статистику прошедших звонков. </p><br /><a name="p-1360-40"></a><p class="auto" id="p-1360-40">
10. Если использовались <u>удаленные MVTS</u>, нужно проверить на&nbsp;них:</p><ul><li> meraproxy.cfg, поправить адреса в&nbsp;секции Radius, на&nbsp;новый адрес АМБС и&nbsp;перегрузить MVTS.
</li><li> /usr/local/billing/etc/bill_util.cfg поправить поле HOST, указать новый адрес АМБС
</li><li> сбросить (через kill -9 ) и&nbsp;запустить по&nbsp;новой демона АМБС &ndash; bill_sig_svr.pl</li></ul>
<br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-41"></a><p class="auto" id="p-1360-41">
<!--notypo--><a name="TECHTT7" href="#TECHTT7" title=""></a>
<!--/notypo--><strong>Вопрос: Можно ли&nbsp;называть шлюзы, роуты операторов на&nbsp;русском языке, система поддерживает кирилицу?</strong></p><br /><a name="p-1360-42"></a><p class="auto" id="p-1360-42">
<strong>Ответ:</strong></p><br /><a name="p-1360-43"></a><p class="auto" id="p-1360-43">
Да, АМБС поддерживает кирилицу:</p><ul><li> Названия шлюзов лучше оставить на&nbsp;латинице, удобнее будет разбирать информацию в&nbsp;консоли на&nbsp;сервере.
</li><li> Названия направлений в&nbsp;тарифных планах можно создавать на&nbsp;кирилице, их&nbsp;названия хранятся в&nbsp;базе и&nbsp;используются только для&nbsp;отображения в&nbsp;веб-интерфейсе.
</li><li> Для&nbsp;названий операторов их&nbsp;реквизитов можно также использовать кирилицу. </li></ul>
<br /><a name="p-1360-44"></a><p class="auto" id="p-1360-44">
Придерживайтесь золотой середины:</p><ul><li> все&nbsp;внутренние названия (названия шлюзов, логины пользователей и&nbsp;т.д.) пишем латиницей,
</li><li> внешние названия, которые будут отправляться партнерам (названия операторов их&nbsp;реквизиты, названия направлений) можно заводить на&nbsp;кирилице.</li></ul>
<br /><a name="p-1360-45"></a><p class="auto" id="p-1360-45">
Будьте внимательны с&nbsp;кодировкой, Linux и&nbsp;Windows это&nbsp;разные ОС, старайтесь использовать CP1251.</p><br />
<hr noshade="noshade" size="1" />
<br /><a name="p-1360-46"></a><p class="auto" id="p-1360-46">
<!--notypo--><a name="TECHTT8" href="#TECHTT8" title=""></a>
<!--/notypo--><strong>Вопрос: Как&nbsp;проверить состояние буфера загрузки новых звонков в&nbsp;базу АМБС?</strong></p><br /><a name="p-1360-47"></a><p class="auto" id="p-1360-47">
<strong>Ответ:</strong></p><br /><a name="p-1360-48"></a><p class="auto" id="p-1360-48">
&ndash; За&nbsp;работу буфера отвечает процесс &#147;load_buffer.pl&#148;. Если объем звонков  большой, тогда процесс будет присутствовать в&nbsp;активных процессах. <br />
ps&nbsp;ax | grep load_buffer.pl</p><br /><a name="p-1360-49"></a><p class="auto" id="p-1360-49">
&ndash; Если что-нибудь мешает нормальной работе буфера загрузки звонков, ошибки будут записаны в&nbsp;лог работы буфера, в&nbsp;файл &laquo;billing/logs/load_buffer.err&raquo; . 	<br />
less billing/logs/load_buffer.err</p><br /><a name="p-1360-50"></a><p class="auto" id="p-1360-50">
&ndash; Для&nbsp;своей работы буфер использует две&nbsp;&laquo;ротируемые&raquo; таблицы. Одна таблица(CDRBUFFER) используется для&nbsp;получения звонков от&nbsp;радиуса, <br />
в&nbsp;то время как&nbsp;из&nbsp;второй таблицы(CDRBUFFER_READ) данные загружаются в&nbsp;базу. После того как&nbsp;звонки загружены в&nbsp;базу таблицы меняются местами. <br />
Можно посмотреть количество записей в&nbsp;этих таблицах следующими командами:<br />
SELECT COUNT(*) FROM CDRBUFFER;<br />
SELECT COUNT(*) FROM CDRBUFFER_READ;</p><br /><a name="p-1360-51"></a><p class="auto" id="p-1360-51">
&ndash; В&nbsp;процессе работы буфер записывает количество обработанных и&nbsp;занесенных в&nbsp;базу звонков в&nbsp;лог &laquo;billing/logs/ipstudio.log&raquo; <br />
в&nbsp;следующем виде "[load_buffer]: Trace level undefined, Current position:10000"<br />
По&nbsp;этим записям можно отслеживать количество уже&nbsp;обработанных звонков.<br />
tail -n 500 billing/logs/ipstudio.log | grep  'load_buffer'</p><br /><a name="p-1360-52"></a><p class="auto" id="p-1360-52">
Можно скомбинировать запрос количества уже&nbsp;загруженных звонков из&nbsp;лога и&nbsp;выборку общего количества звонков в&nbsp;буферных таблицах, например так: <br />
tail -n 300 ipstudio.log | grep  'load_buffer' | tail -n 1 && mysql -u&lt;имя_mysql_пользователя&gt; -p&lt;пароль_mysql_пользователя&gt; -D voip -e 'select &#147;CDRBUFFER&#148;,count(*) from CDRBUFFER union select &#147;CDRBUFFER_READ&#148;,count(*) from CDRBUFFER_READ;'</p><br /><a name="p-1360-53"></a><p class="auto" id="p-1360-53">
где, <br />
&lt;имя_mysql_пользователя&gt; и&nbsp;&lt;пароль_mysql_пользователя&gt; можно взять из&nbsp;конфиг-файла АМБС (billing/etc/bill_util.cfg, параметры &ndash; USER, PASS).</p><br /><a name="p-1360-54"></a><p class="auto" id="p-1360-54">
Результат получится следующего вида:<br />
<!--notypo--><div class="code"><pre>2010/07/21 12:11:05 [load_buffer]: Trace level undefined<span style="color:#4400DD">,</span> Current position:10000
+----------------+----------+
<span style="color:#4400DD">|</span> CDRBUFFER      <span style="color:#4400DD">|</span> count(*) <span style="color:#4400DD">|</span>
+----------------+----------+
<span style="color:#4400DD">|</span> CDRBUFFER      <span style="color:#4400DD">|</span>      384 <span style="color:#4400DD">|</span>
<span style="color:#4400DD">|</span> CDRBUFFER_READ <span style="color:#4400DD">|</span>      211 <span style="color:#4400DD">|</span>
+----------------+----------+</pre></div><!--/notypo--></p><br />
<hr noshade="noshade" size="1" />   <script language="JavaScript" type="text/javascript">
   var dbclick = "page";
  </script>
 <br style="clear:both" />&nbsp;
</div>

<form action="http://78.46.73.113/wiki/wakka.php?wakka=TextSearch"  method="get" >
<input type="hidden" name="wakka" value="TextSearch" />
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="footer">
	<tr>
		<td>
			 
			
			  <span class="searchbar nobr">Поиск: <input type="text" name="phrase" size="25" style="border: none; border-bottom: 1px solid #CCCCAA; padding: 0px; margin: 0px;" /></span>
		</td>
		<td align="right">
			<a href="wakkaefce.html?wakka=ChastyeVoprosyIotvetyPoAMBS/VoprosyPoustanovkeAMBS/print" target="_new"><img src="themes/default/icons/1print.gif" title="Версия для печати" alt="Версия для печати"  align="middle" border="0" /></a>		</td>
	</tr>
</table>

</form>


<table class="copyright" width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td align="left" class="copyright">
			Created by <a target="_blank" class="copyright" href="http://www.ipstudio.net/">IP Studio Inc.</a>© 2007
		</td>
		<td align="right" class="copyright">
			Powered by <a href="http://wackowiki.com/WackoWiki" target="_blank" title="" class="outerlink">WackoWiki R4.2</a>		</td>
	</tr>
</table>

</td>
</tr>
</table>
</body>
<!-- Mirrored from 78.46.73.113/wiki/wakka.php?wakka=ChastyeVoprosyIotvetyPoAMBS/VoprosyPoustanovkeAMBS&v=osy by HTTrack Website Copier/3.x [XR&CO'2006], Wed, 25 Jul 2012 16:06:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=windows-1251"><!-- /Added by HTTrack -->
</html>